{% extends 'partials/layout.twig' %}
{% block conten %}
    <div class="page-header">
        <h4>Ficha de Registro de Usuarios</h4>
    </div>
    {#<form action="{{ 'mantenimiento/guardarusuario'|url }}" method="post">#}
    <form action="{{ 'mantenimiento/usuarios/guardarusuario'|url  }}" id="nusuario" method="post">
        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" name="nombre" class="form-control" placeholder="Ingrese su nombre">
                    <label data-key="nombre" class="form-validation-failed requireed"></label>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Apellido Paterno</label>
                    <input type="text" name="apaterno" class="form-control" placeholder="Ingrese su apellido paterno">
                    <label data-key="apaterno" class="form-validation-failed requireed"></label>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Apellido Materno</label>
                    <input type="text" name="amaterno" class="form-control" placeholder="Ingrese su apellido materno">
                    <label data-key="amaterno" class="form-validation-failed requireed"></label>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label>Correo Electronico</label>
                    <input type="email" name="correo" class="form-control" placeholder="Ingrese el correo electronico">
                    <label data-key="correo" class="form-validation-failed requireed"></label>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" autocomplete="off" name="password" class="form-control" placeholder="Ingrese la contraseña">
                    <label data-key="password" class="form-validation-failed requireed"></label>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label>Rol</label>
                    <select name="rol_id" id="" class="form-control">
                        <option value="" selected disabled>Elegir rol</option>
                        {% for rol in roles %}
                            <option value="{{ rol.id }}">{{ rol.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="text-right">
                <a href="{{ 'mantenimiento/usuarios/'|url }}" class="btn btn-default">
                    Cancelar
                </a>
                <button data-ajax="true" id="btnGuardar" class="btn btn-primary" type="submit">
                    Guardar
                </button>
            </div>
        </div>


    </form>
{% endblock %}
{% block script %}
    {# <script>
        var block = $('<div class="block-loading"></div>');

        $('body').on('click', '#btnGuardar', function(){
            var objForm = $('form');
            $.ajax({
                url: '{{ 'mantenimiento/guardarusuario'|url }}',
                type: 'POST',
                dataType: 'JSON',
                data: objForm.serialize(),
                preventDefault: function(){
                    objForm.prepend(block);
                    console.log("Realizando peticion para agregar un nuevo usuario");
                },
                success: function(res){
                    block.remove();
                    console.log(res);
                    if(!res.response){
                        swal('Ups!', `Error: ${res.message}`, '');
                    }else{
                        swal('Good job!', res.message, 'success').
                            then(function(okey){
                                if(okey){
                                    var route = '{{ ''|url }}' + res.href;
                                    $(location).attr('href', route);
                                }

                            })
                    }
                    
                },
                error: function(req, status, err){
                    block.remove();
                    swal('Ups!', `Error: ${err}`, 'error');
                    console.log(err);
                }
            });
            return false;
        });
    </script> #}
{% endblock %}